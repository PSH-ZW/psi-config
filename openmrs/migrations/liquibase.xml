<?xml version="1.0" encoding="UTF-8"?>

<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-2.0.xsd
        http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd">

        <changeSet id="PSI-CONFIG-1802271552" author="Pritam">
            <preConditions onFail="MARK_RAN">
                <sqlCheck expectedResult="0">
                          SELECT count(*) FROM INFORMATION_SCHEMA.ROUTINES WHERE ROUTINE_TYPE="PROCEDURE"  AND ROUTINE_SCHEMA="openmrs" and ROUTINE_NAME='add_concept_psi';
                   </sqlCheck>
            </preConditions>
            <comment>Adding the Procedure for creating concepts in Fr</comment>
            <sqlFile splitStatements="false" path="AddConceptProc.sql"/>
        </changeSet>
        <changeSet id="PSI-CONFIG-1802271133" author="Pritam">
        <comment>Adding All Concepts related to drug</comment>
        <sqlFile path="AddAllDrugConcepts.sql"/>
        </changeSet>
        <changeSet id="OCB-CONFIG-18022713213" author="Pritam">
        <comment>Adding Drugs to the Drug template</comment>
        <sqlFile path="AddDrugConceptsToDrugForm.sql"/>
        </changeSet>

        <changeSet id="PSI-CONFIG-1802271608" author="Pritam">
         <comment>Adding entries in event_records table for newly created drugs</comment>
         <sql>
             set @uuid = NULL;

             select uuid into @uuid from concept where concept_id = (select concept_id from concept_name where name = 'Tenofovir + Lamivudine + Efavirenz' and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0);
             INSERT INTO event_records (uuid,title,timestamp,uri,object,category,date_created,tags) VALUES (uuid(),"concepts",now(),concat("/openmrs/ws/rest/v1/concept/",@uuid,"?s=byFullySpecifiedName&amp;amp;v=bahmni&amp;amp;name=","Tenofovir + Lamivudine + Efavirenz"),concat("/openmrs/ws/rest/v1/concept/",@uuid,"?s=byFullySpecifiedName&amp;amp;v=bahmni&amp;name=","Tenofovir + Lamivudine + Efavirenz"),"all-concepts",now(),"drug-concepts");

             select uuid into @uuid from concept where concept_id = (select concept_id from concept_name where name = 'Zidovudine + Lamivudine + Nevirapine' and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0);
             INSERT INTO event_records (uuid,title,timestamp,uri,object,category,date_created,tags) VALUES (uuid(),'concepts',now(),concat('/openmrs/ws/rest/v1/concept/',@uuid,'?s=byFullySpecifiedName&amp;v=bahmni&amp;name=','Zidovudine + Lamivudine + Nevirapine'),concat('/openmrs/ws/rest/v1/concept/',@uuid,'?s=byFullySpecifiedName&amp;v=bahmni&amp;name=','Zidovudine + Lamivudine + Nevirapine'),'all-concepts',now(),'drug-concepts');

             select uuid into @uuid from concept where concept_id = (select concept_id from concept_name where name = 'Tenofovir + Lamivudine' and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0);
             INSERT INTO event_records (uuid,title,timestamp,uri,object,category,date_created,tags)
             VALUES (uuid(),'concepts',now(),concat('/openmrs/ws/rest/v1/concept/',@uuid,'?s=byFullySpecifiedName&amp;v=bahmni&amp;name=','Tenofovir + Lamivudine'),concat('/openmrs/ws/rest/v1/concept/',@uuid,'?s=byFullySpecifiedName&amp;v=bahmni&amp;name=','Tenofovir + Lamivudine'),'all-concepts',now(),'drug-concepts');

             select uuid into @uuid from concept where concept_id = (select concept_id from concept_name where name = 'Tenofovir + Emtricitabine' and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0);
             INSERT INTO event_records (uuid,title,timestamp,uri,object,category,date_created,tags)
             VALUES (uuid(),'concepts',now(),concat('/openmrs/ws/rest/v1/concept/',@uuid,'?s=byFullySpecifiedName&amp;v=bahmni&amp;name=','Tenofovir + Emtricitabine'),concat('/openmrs/ws/rest/v1/concept/',@uuid,'?s=byFullySpecifiedName&amp;v=bahmni&amp;name=','Tenofovir + Emtricitabine'),'all-concepts',now(),'drug-concepts');

             select uuid into @uuid from concept where concept_id = (select concept_id from concept_name where name = 'Zidovudine + Lamivudine' and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0);
             INSERT INTO event_records (uuid,title,timestamp,uri,object,category,date_created,tags)
             VALUES (uuid(),'concepts',now(),concat('/openmrs/ws/rest/v1/concept/',@uuid,'?s=byFullySpecifiedName&amp;v=bahmni&amp;name=','Zidovudine + Lamivudine'),concat('/openmrs/ws/rest/v1/concept/',@uuid,'?s=byFullySpecifiedName&amp;v=bahmni&amp;name=','Zidovudine + Lamivudine'),'all-concepts',now(),'drug-concepts');

             select uuid into @uuid from concept where concept_id = (select concept_id from concept_name where name = 'Abacavir/Lamivudine' and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0);
             INSERT INTO event_records (uuid,title,timestamp,uri,object,category,date_created,tags)
             VALUES (uuid(),'concepts',now(),concat('/openmrs/ws/rest/v1/concept/',@uuid,'?s=byFullySpecifiedName&amp;v=bahmni&amp;name=','Abacavir/Lamivudine'),concat('/openmrs/ws/rest/v1/concept/',@uuid,'?s=byFullySpecifiedName&amp;v=bahmni&amp;name=','Abacavir/Lamivudine'),'all-concepts',now(),'drug-concepts');

             select uuid into @uuid from concept where concept_id = (select concept_id from concept_name where name = 'Atazanavir/Rtv' and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0);
             INSERT INTO event_records (uuid,title,timestamp,uri,object,category,date_created,tags)
             VALUES (uuid(),'concepts',now(),concat('/openmrs/ws/rest/v1/concept/',@uuid,'?s=byFullySpecifiedName&amp;v=bahmni&amp;name=','ZAtazanavir/Rtv'),concat('/openmrs/ws/rest/v1/concept/',@uuid,'?s=byFullySpecifiedName&amp;v=bahmni&amp;name=','Atazanavir/Rtv'),'all-concepts',now(),'drug-concepts');

             select uuid into @uuid from concept where concept_id = (select concept_id from concept_name where name = 'Lopinavir/Rtv' and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0);
             INSERT INTO event_records (uuid,title,timestamp,uri,object,category,date_created,tags)
             VALUES (uuid(),'concepts',now(),concat('/openmrs/ws/rest/v1/concept/',@uuid,'?s=byFullySpecifiedName&amp;v=bahmni&amp;name=','Lopinavir/Rtv'),concat('/openmrs/ws/rest/v1/concept/',@uuid,'?s=byFullySpecifiedName&amp;v=bahmni&amp;name=','Lopinavir/Rtv'),'all-concepts',now(),'drug-concepts');

             select uuid into @uuid from concept where concept_id = (select concept_id from concept_name where name = 'Tenofovir (TDF) 300mg + Lamivudine (3TC) 300mg + Efavirenz (EFV) 600mg' and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0);
             INSERT INTO event_records (uuid,title,timestamp,uri,object,category,date_created,tags) VALUES (uuid(),'drug',now(),concat('/openmrs/ws/rest/v1/reference-data/drug/',@uuid),concat('/openmrs/ws/rest/v1/reference-data/drug/',@uuid),'drug',now(),'drug');

             select uuid into @uuid from concept where concept_id = (select concept_id from concept_name where name = 'Tenofovir (TDF) 300mg + Lamivudine (3TC) 300mg + Efavirenz (EFV) 400mg' and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0);
             INSERT INTO event_records (uuid,title,timestamp,uri,object,category,date_created,tags) VALUES (uuid(),'drug',now(),concat('/openmrs/ws/rest/v1/reference-data/drug/',@uuid),concat('/openmrs/ws/rest/v1/reference-data/drug/',@uuid),'drug',now(),'drug');

             select uuid into @uuid from concept where concept_id = (select concept_id from concept_name where name = 'Zidovudine (AZT) 300mg + Lamivudine (3TC) 150mg + Nevirapine (NVP) 200mg' and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0);
             INSERT INTO event_records (uuid,title,timestamp,uri,object,category,date_created,tags) VALUES (uuid(),'drug',now(),concat('/openmrs/ws/rest/v1/reference-data/drug/',@uuid),concat('/openmrs/ws/rest/v1/reference-data/drug/',@uuid),'drug',now(),'drug');

             select uuid into @uuid from concept where concept_id = (select concept_id from concept_name where name = 'Zidovudine (AZT) 60mg + Lamivudine (3TC) 30mg + Nevirapine (NVP) 50mg' and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0);
             INSERT INTO event_records (uuid,title,timestamp,uri,object,category,date_created,tags) VALUES (uuid(),'drug',now(),concat('/openmrs/ws/rest/v1/reference-data/drug/',@uuid),concat('/openmrs/ws/rest/v1/reference-data/drug/',@uuid),'drug',now(),'drug');

             select uuid into @uuid from concept where concept_id = (select concept_id from concept_name where name = 'Tenofovir (TDF) 300mg + Lamivudine (3TC) 300mg' and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0);
             INSERT INTO event_records (uuid,title,timestamp,uri,object,category,date_created,tags) VALUES (uuid(),'drug',now(),concat('/openmrs/ws/rest/v1/reference-data/drug/',@uuid),concat('/openmrs/ws/rest/v1/reference-data/drug/',@uuid),'drug',now(),'drug');

             select uuid into @uuid from concept where concept_id = (select concept_id from concept_name where name = 'Tenofovir (TDF) 300mg + Emtricitabine 200mg' and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0);
             INSERT INTO event_records (uuid,title,timestamp,uri,object,category,date_created,tags) VALUES (uuid(),'drug',now(),concat('/openmrs/ws/rest/v1/reference-data/drug/',@uuid),concat('/openmrs/ws/rest/v1/reference-data/drug/',@uuid),'drug',now(),'drug');

             select uuid into @uuid from concept where concept_id = (select concept_id from concept_name where name = 'Zidovudine (AZT) 300mg + Lamivudine (3TC) 150mg' and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0);
             INSERT INTO event_records (uuid,title,timestamp,uri,object,category,date_created,tags) VALUES (uuid(),'drug',now(),concat('/openmrs/ws/rest/v1/reference-data/drug/',@uuid),concat('/openmrs/ws/rest/v1/reference-data/drug/',@uuid),'drug',now(),'drug');

             select uuid into @uuid from concept where concept_id = (select concept_id from concept_name where name = 'Zidovudine (AZT) 60mg + Lamivudine (3TC) 30mg' and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0);
             INSERT INTO event_records (uuid,title,timestamp,uri,object,category,date_created,tags) VALUES (uuid(),'drug',now(),concat('/openmrs/ws/rest/v1/reference-data/drug/',@uuid),concat('/openmrs/ws/rest/v1/reference-data/drug/',@uuid),'drug',now(),'drug');

             select uuid into @uuid from concept where concept_id = (select concept_id from concept_name where name = 'Abacavir 600mg/Lamivudine 300mg' and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0);
             INSERT INTO event_records (uuid,title,timestamp,uri,object,category,date_created,tags) VALUES (uuid(),'drug',now(),concat('/openmrs/ws/rest/v1/reference-data/drug/',@uuid),concat('/openmrs/ws/rest/v1/reference-data/drug/',@uuid),'drug',now(),'drug');

             select uuid into @uuid from concept where concept_id = (select concept_id from concept_name where name = 'Abacavir 60mg/Lamivudine 30mg' and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0);
             INSERT INTO event_records (uuid,title,timestamp,uri,object,category,date_created,tags) VALUES (uuid(),'drug',now(),concat('/openmrs/ws/rest/v1/reference-data/drug/',@uuid),concat('/openmrs/ws/rest/v1/reference-data/drug/',@uuid),'drug',now(),'drug');

             select uuid into @uuid from concept where concept_id = (select concept_id from concept_name where name = 'Atazanavir/Rtv 300/100 mg' and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0);
             INSERT INTO event_records (uuid,title,timestamp,uri,object,category,date_created,tags) VALUES (uuid(),'drug',now(),concat('/openmrs/ws/rest/v1/reference-data/drug/',@uuid),concat('/openmrs/ws/rest/v1/reference-data/drug/',@uuid),'drug',now(),'drug');

             select uuid into @uuid from concept where concept_id = (select concept_id from concept_name where name = 'Lopinavir/Rtv 80/20 mg/ml' and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0);
             INSERT INTO event_records (uuid,title,timestamp,uri,object,category,date_created,tags) VALUES (uuid(),'drug',now(),concat('/openmrs/ws/rest/v1/reference-data/drug/',@uuid),concat('/openmrs/ws/rest/v1/reference-data/drug/',@uuid),'drug',now(),'drug');

             select uuid into @uuid from concept where concept_id = (select concept_id from concept_name where name = 'Lopinavir/Rtv 100/25 mg' and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0);
             INSERT INTO event_records (uuid,title,timestamp,uri,object,category,date_created,tags) VALUES (uuid(),'drug',now(),concat('/openmrs/ws/rest/v1/reference-data/drug/',@uuid),concat('/openmrs/ws/rest/v1/reference-data/drug/',@uuid),'drug',now(),'drug');

             select uuid into @uuid from concept where concept_id = (select concept_id from concept_name where name = 'Lopinavir/Rtv 200/50 mg' and concept_name_type = 'FULLY_SPECIFIED' and locale = 'en' and voided = 0);
             INSERT INTO event_records (uuid,title,timestamp,uri,object,category,date_created,tags) VALUES (uuid(),'drug',now(),concat('/openmrs/ws/rest/v1/reference-data/drug/',@uuid),concat('/openmrs/ws/rest/v1/reference-data/drug/',@uuid),'drug',now(),'drug');

</sql>
       </changeSet>

</databaseChangeLog>
